!function(s){"use strict";var a={serverPath:"",fileFieldName:"fileToUpload",data:[],headers:{},xhrFields:{},urlPropertyName:"file",statusPropertyName:"success",success:void 0,error:void 0,imageWidthModalEdit:!1};function d(e,a){var r=a.shift(),t=a;if(null!==e){if(0===t.length)return e[r];if("object"==typeof e)return d(e[r],t)}return e}!function(){if(!s.trumbowyg.addedXhrProgressEvent){var r=s.ajaxSettings.xhr;s.ajaxSetup({xhr:function(){var e=r(),a=this;return e&&"object"==typeof e.upload&&void 0!==a.progressUpload&&e.upload.addEventListener("progress",function(e){a.progressUpload(e)},!1),e}}),s.trumbowyg.addedXhrProgressEvent=!0}}(),s.extend(!0,s.trumbowyg,{langs:{en:{upload:"Upload",file:"File",uploadError:"Error"},ko:{upload:"업로드",file:"파일",uploadError:"오류"}},plugins:{upload:{init:function(i){i.o.plugins.upload=s.extend(!0,{},a,i.o.plugins.upload||{});var e={fn:function(){i.saveRange();var o,a=i.o.prefix,e={file:{type:"file",required:!0,attributes:{accept:"image/*"}},alt:{label:"description",value:i.getRangeText()}};i.o.plugins.upload.imageWidthModalEdit&&(e.width={value:""});var l=i.openModalInsert(i.lang.upload,e,function(t){var r=new FormData;r.append(i.o.plugins.upload.fileFieldName,o),i.o.plugins.upload.data.map(function(e){r.append(e.name,e.value)}),s.map(t,function(e,a){"file"!==a&&r.append(a,e)}),0===s("."+a+"progress",l).length&&s("."+a+"modal-title",l).after(s("<div/>",{class:a+"progress"}).append(s("<div/>",{class:a+"progress-bar"}))),s.ajax({url:i.o.plugins.upload.serverPath,headers:i.o.plugins.upload.headers,xhrFields:i.o.plugins.upload.xhrFields,type:"POST",data:r,cache:!1,dataType:"json",processData:!1,contentType:!1,progressUpload:function(e){s("."+a+"progress-bar").css("width",Math.round(100*e.loaded/e.total)+"%")},success:function(e){if(i.o.plugins.upload.success)i.o.plugins.upload.success(e,i,l,t);else if(d(e,i.o.plugins.upload.statusPropertyName.split("."))){var a=d(e,i.o.plugins.upload.urlPropertyName.split("."));i.execCmd("insertImage",a,!1,!0);var r=s('img[src="'+a+'"]:not([alt])',i.$box);r.attr("alt",t.alt),i.o.imageWidthModalEdit&&0<parseInt(t.width)&&r.attr({width:t.width}),setTimeout(function(){i.closeModal()},250),i.$c.trigger("tbwuploadsuccess",[i,e,a])}else i.addErrorOnModalField(s("input[type=file]",l),i.lang[e.message]),i.$c.trigger("tbwuploaderror",[i,e])},error:i.o.plugins.upload.error||function(){i.addErrorOnModalField(s("input[type=file]",l),i.lang.uploadError),i.$c.trigger("tbwuploaderror",[i])}})});s("input[type=file]").on("change",function(a){try{o=a.target.files[0]}catch(e){o=a.target.value}})}};i.addBtnDef("upload",e)}}}})}(jQuery);